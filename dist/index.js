"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},n.apply(this,arguments)}const l={SetRepeat:"SetRepeat",SetFrequency:"SetFrequency",SetMonthOption:"SetMonthOption",SetSelectedWeeks:"SetSelectedWeeks",SetMonthDate:"SetMonthDate",SetMonthDay:"SetMonthDay",SetMonthDayOrder:"SetMonthDayOrder",SetInitialProps:"SetInitialProps",SetEndType:"SetEndType",SetEndDate:"SetEndDate",SetEndCount:"SetEndCount",SetStartDate:"SetStartDate",SetCronExp:"SetCronExp"},o=(e=null)=>{let t=new Date;e&&(t=new Date(e));let a=t.getDate(),n=t.getMonth()+1;return a<10&&(a=`0${a}`),n<10&&(n=`0${n}`),`${t.getFullYear()}-${n}-${a}`},r=e=>"number"==typeof e?o(e):e,d=(e,t)=>{switch(t.type){case l.SetRepeat:return{...e,repeat:t.payload};case l.SetFrequency:return{...e,frequency:Number(t.payload)};case l.SetMonthOption:return{...e,monthOption:t.payload};case l.SetSelectedWeeks:return{...e,selectedWeeks:t.payload||[]};case l.SetMonthDate:return{...e,selectedMonthDate:Number(t.payload)};case l.SetMonthDay:return{...e,selectedMonthDay:t.payload};case l.SetMonthDayOrder:return{...e,selectedMonthDayOrder:t.payload};case l.SetStartDate:return{...e,startDate:t.payload};case l.SetEndType:return{...e,selectedEndType:t.payload};case l.SetEndDate:return{...e,endDate:t.payload};case l.SetEndCount:return{...e,endCount:Number(t.payload)};case l.SetInitialProps:return{...e,repeat:t.payload?.repeat,disabled:t.payload?.disabled,showFrequency:t.payload?.showFrequency,frequency:t.payload?.frequency||1,startDate:t.payload?.startDate?r(t.payload?.startDate):o(),endDate:t.payload?.endDate?r(t.payload?.endDate):o(),selectedEndType:t.payload?.selectedEndType||"noend",endCount:t.payload?.endCount||10,selectedWeeks:t.payload?.selectedWeeks||[(new Date).getDay()],monthOption:t.payload?.monthOption||"standard",selectedMonthDate:t.payload?.selectedMonthDate||(new Date).getDate(),selectedMonthDayOrder:t.payload?.selectedMonthDayOrder||"First",selectedMonthDay:t.payload?.selectedMonthDay||"Day"};case l.SetCronExp:return{...e,cronExpression:t.payload};default:return e}},c=e.createContext({}),i={repeat:"weekly",frequency:1,selectedWeeks:[(new Date).getDay()],monthOption:"standard",selectedMonthDate:(new Date).getDate(),selectedMonthDayOrder:"First",selectedMonthDay:"Day",selectedEndType:"noend",startDate:o(),endDate:o(),endCount:10,disabled:!1,showFrequency:!0,cronExpression:""};var u=t=>{const[n,l]=e.useReducer(d,i);return a.default.createElement(c.Provider,{value:{recurrenceData:n,dispatch:l}},t.children)};const s=[{name:"Sunday",value:0},{name:"Monday",value:1},{name:"Tuesday",value:2},{name:"Wednesday",value:3},{name:"Thursday",value:4},{name:"Friday",value:5},{name:"Saturday",value:6}],m=["January","February","March","April","May","June","July","August","September","October","November","December"],p=e=>e&&e.length>0?7===e.length?"0 0 ? * ?":(e.sort(),`0 0 ? * ${e.join(",")}`):"",y=e=>e&&e>=1&&e<=31?`0 0 ${e} * ?`:"",_=e=>{const t=s.find((t=>t.name===e))?.value;return t>=0&&t<=6?`0 0 ? * ${t}L`:""},h=(e,t)=>{const a=s.find((e=>e.name===t))?.value;return e>=1&&e<=4&&a>=0&&a<=6?`0 0 ? * ${a}#${e}`:""},f=e=>"First"===e?1:"Second"===e?2:"Third"===e?3:"Fourth"===e?4:5,S=e=>1===e||"1"===e?"First":2===e||"2"===e?"Second":3===e||"3"===e?"Third":4===e||"4"===e?"Fourth":"Last",D=(e,t)=>{if(!t)return{};const a=t.split(" ");if(a.length<5)return{};const n={},l=a[4],o=a[3],r=a[2];if("weekly"===e){if(n.selectedWeeks="?"===l?[0,1,2,3,4,5,6]:l.split(",").map((e=>Number(e))),"?"===l)return n.selectedWeeks=[0,1,2,3,4,5,6],n;const e=[];return l.split(",").forEach((t=>{if(Number.isNaN(t)||Number.isNaN(parseFloat(t))){const n="SUN"===(a=t)?.toUpperCase()?0:"MON"===a?.toUpperCase()?1:"TUE"===a?.toUpperCase()?2:"WED"===a?.toUpperCase()?3:"THU"===a?.toUpperCase()?4:"FRI"===a?.toUpperCase()?5:"SAT"===a?.toUpperCase()?6:void 0;n&&e.push(n)}else e.push(Number(t));var a})),n.selectedWeeks=e,n}if("*"===o&&"monthly"===e){if("?"===l&&!isNaN(r)&&!isNaN(parseFloat(r)))return n.monthOption="standard",n.selectedMonthDate=Number(r),n;if(n.monthOption="custom","?"===l)r.includes("L")&&(n.selectedMonthDayOrder="Last"),r.includes("W")?(n.selectedMonthDay="Weekday",n.selectedMonthDayOrder=S(r.slice(0,1))):n.selectedMonthDay="Day";else if(l.includes("L")){const e=s.find((e=>e.value===Number(l.slice(0,1))));n.selectedMonthDay=e?.name}else if(l.includes("#")){n.selectedMonthDayOrder=S(l.charAt(l.length-1));const e=s.find((e=>e.value===Number(l.slice(0,1))));n.selectedMonthDay=e?.name}return n}return n};function E(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===a&&n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var b={mainContainer:"DateSelection-module_mainContainer__Jn8mk",endTypeSelector:"DateSelection-module_endTypeSelector__o9x-Y",endContainer:"DateSelection-module_endContainer__vEHSM",startDate:"DateSelection-module_startDate__-Y2W4",endSelector:"DateSelection-module_endSelector__B6zvu",input:"DateSelection-module_input__yes3x"};function C(){const{recurrenceData:t,dispatch:n}=e.useContext(c),{selectedEndType:o,startDate:r,endDate:d,endCount:i,disabled:u}=t;return a.default.createElement("div",{className:b.mainContainer},a.default.createElement("div",{className:b.startContainer},a.default.createElement("label",{for:"start"},"Start"),a.default.createElement("input",{disabled:u,value:r,onChange:e=>{n({type:l.SetStartDate,payload:e?.target?.value})},className:b.startDate,type:"date",id:"start",name:"start"})),a.default.createElement("div",{className:b.endContainer},a.default.createElement("label",null,"End"),a.default.createElement("select",{disabled:u,value:o,className:b.endTypeSelector,onChange:e=>{n({type:l.SetEndType,payload:e?.target?.value})}},a.default.createElement("option",{value:"noend"},"no end date"),a.default.createElement("option",{value:"date"},"on this day"),a.default.createElement("option",{value:"count"},"after")),"date"===o?a.default.createElement("input",{disabled:u,value:d,onChange:e=>{n({type:l.SetEndDate,payload:e?.target?.value})},className:b.endDate,type:"date",id:"end",name:"end"}):"count"===o?a.default.createElement(a.default.Fragment,null,a.default.createElement("input",{disabled:u,value:i,onChange:e=>{n({type:l.SetEndCount,payload:e?.target?.value})},className:b.input,type:"number",min:1,defaultValue:10}),a.default.createElement("label",{style:{marginLeft:10}},"occurance")):null))}E("@media only screen and (min-width:641px){.DateSelection-module_mainContainer__Jn8mk{display:flex;flex-direction:row}.DateSelection-module_endTypeSelector__o9x-Y{margin-left:20px}}@media only screen and (max-width:641px){.DateSelection-module_endContainer__vEHSM{margin-top:20px}.DateSelection-module_endTypeSelector__o9x-Y{margin-left:24px}}.DateSelection-module_mainContainer__Jn8mk{margin-top:20px}.DateSelection-module_startDate__-Y2W4{margin-left:20px;margin-right:20px}.DateSelection-module_endTypeSelector__o9x-Y{margin-right:20px}.DateSelection-module_endSelector__B6zvu{margin-left:20px;margin-right:20px}.DateSelection-module_input__yes3x{width:50px}");var g={mainContainer:"Frequency-module_mainContainer__uyQ55",frequencyContainer:"Frequency-module_frequencyContainer__VDM6E",input:"Frequency-module_input__wuVfu",labelRepeat:"Frequency-module_labelRepeat__kpSyh",selectRepeat:"Frequency-module_selectRepeat__yPTcE",labelEvery:"Frequency-module_labelEvery__tvws5",labelResult:"Frequency-module_labelResult__NlacK"};E("@media only screen and (min-width:641px){.Frequency-module_mainContainer__uyQ55{display:flex;flex-direction:row}}@media only screen and (max-width:641px){.Frequency-module_frequencyContainer__VDM6E{margin-top:20px}.Frequency-module_input__wuVfu{margin-left:6px}}.Frequency-module_labelRepeat__kpSyh{margin-right:20px}.Frequency-module_selectRepeat__yPTcE{margin-right:40px;width:80px}.Frequency-module_labelEvery__tvws5{margin-right:20px}.Frequency-module_input__wuVfu{width:50px}.Frequency-module_labelResult__NlacK{margin-left:10px}");const v=["weekly","monthly"];function x(t){const{recurrenceData:n,dispatch:o}=e.useContext(c),{repeat:r,showFrequency:d,frequency:i,disabled:u}=n;return a.default.createElement("div",{className:g.mainContainer,style:t?.styles?.frequencyContainer},a.default.createElement("div",null,a.default.createElement("label",{className:g.labelRepeat},"Repeat"),a.default.createElement("select",{disabled:u,value:r,className:g.selectRepeat,name:"repeat",id:"repeat",onChange:e=>{o({type:l.SetRepeat,payload:e?.target?.value})}},v.map((e=>a.default.createElement("option",{value:e},e))))),d&&a.default.createElement("div",{className:g.frequencyContainer},a.default.createElement("label",{className:g.labelEvery},"Every"),a.default.createElement("input",{disabled:u,className:g.input,value:i,onChange:e=>{o({type:l.SetFrequency,payload:e?.target?.value})},type:"number",min:1,defaultValue:1}),a.default.createElement("label",{className:g.labelResult},r.slice(0,-2),"(s)")))}var k={container:"MonthSelection-module_container__7AbBI",orLabel:"MonthSelection-module_orLabel__jqTMH",mainContainer:"MonthSelection-module_mainContainer__Orlve",standardContainer:"MonthSelection-module_standardContainer__1EEb-",customContainer:"MonthSelection-module_customContainer__4XPHq",dateSelector:"MonthSelection-module_dateSelector__C1fNg",daySelector:"MonthSelection-module_daySelector__KkPVH",dayLabel:"MonthSelection-module_dayLabel__C04BX",onLabel:"MonthSelection-module_onLabel__TJ8AO"};E("@media only screen and (min-width:641px){.MonthSelection-module_container__7AbBI{display:flex;flex-direction:row}}@media only screen and (max-width:641px){.MonthSelection-module_orLabel__jqTMH{visibility:hidden}}.MonthSelection-module_mainContainer__Orlve{display:flex;flex-direction:row;margin-top:20px}.MonthSelection-module_customContainer__4XPHq,.MonthSelection-module_standardContainer__1EEb-{display:flex;flex-direction:row}.MonthSelection-module_dateSelector__C1fNg{margin-left:10px;width:50px}.MonthSelection-module_daySelector__KkPVH{margin-left:10px;margin-right:10px;width:100px}.MonthSelection-module_dayLabel__C04BX,.MonthSelection-module_orLabel__jqTMH{margin-left:10px;margin-right:10px}.MonthSelection-module_onLabel__TJ8AO{margin-right:20px}");const M=[...Array(32).keys()].filter((e=>0!==e)),w=["First","Second","Third","Fourth","Last"];function N(t){const{recurrenceData:n,dispatch:o}=e.useContext(c),{monthOption:r,selectedMonthDate:d,selectedMonthDayOrder:i,selectedMonthDay:u,disabled:m}=n,p=e=>{o({type:l.SetMonthOption,payload:e?.target?.value})};return a.default.createElement("div",{className:k.mainContainer},a.default.createElement("label",{className:k.onLabel},"on"),a.default.createElement("div",{className:k.container},a.default.createElement("div",{className:k.standardContainer},a.default.createElement("input",{disabled:m,value:"standard",name:"monthOption",checked:"standard"===r,type:"radio",onChange:p}),a.default.createElement("select",{disabled:m||"standard"!==r,value:d,className:k.dateSelector,onChange:e=>{o({type:l.SetMonthDate,payload:e?.target?.value})}},M.map((e=>a.default.createElement("option",{value:e},e)))),a.default.createElement("label",{style:{color:""+("standard"!==r||m?"gray":"")},className:k.dayLabel},"day")),a.default.createElement("label",{className:k.orLabel},"or"),a.default.createElement("div",{className:k.customContainer},a.default.createElement("input",{disabled:m,value:"custom",name:"monthOption",checked:"custom"===r,type:"radio",onChange:p}),a.default.createElement("select",{disabled:m||"custom"!==r,value:i,className:k.daySelector,onChange:e=>{o({type:l.SetMonthDayOrder,payload:e?.target?.value})}},w.map((e=>{const t=!["First","Last"].includes(e)&&"Weekday"===u;return a.default.createElement("option",{disabled:t,value:e},e)}))),a.default.createElement("select",{disabled:m||"custom"!==r,value:u,className:k.daySelector,onChange:e=>{o({type:l.SetMonthDay,payload:e?.target?.value})}},(()=>{let e=[...s];return e=e.concat([{name:"Day",value:"Day"},{name:"Weekday",value:"Weekday"}]),e})().map((e=>{const t="Weekday"===e.name&&!["First","Last"].includes(i);return a.default.createElement("option",{disabled:t,value:e.name},e.name)}))))))}const W=e=>{const t=new Date(e),a=s.find((e=>e.value===t?.getDay()))?.name;return a},q=e=>{const t=new Date(e);return m[t.getMonth()]},F=e=>{const t=new Date(e).getDate();return t>9?t:`0${t}`};function O(t){const{recurrenceData:n,dispatch:l}=e.useContext(c),{startDate:o,repeat:r,selectedWeeks:d,frequency:i,monthOption:u,selectedMonthDate:m,selectedMonthDayOrder:p,selectedMonthDay:y}=n,_=e.useCallback((()=>{if(!o)return"";const e=new Date(o),t=W(o),a=q(o);return`starting ${t}, ${F(o)} ${a} ${e.getFullYear()}`}),[o]),h=e.useCallback((()=>{let e=d;if(o){const t=new Date(o);e=d.filter((e=>e>=t.getDay())).concat(d.filter((e=>e<t.getDay())))}const t=[];if(e.forEach((e=>{const a=s.find((t=>t.value===e));a.name&&t.push(a.name)})),t.length>1){const e=t.pop(),a=t.pop();t.push(`${a} and ${e}`)}return t.join(", ")}),[o,d]);if("weekly"===r&&d?.length>0)return a.default.createElement("div",{style:{marginTop:20}},"Occurs",a.default.createElement("span",{style:{fontWeight:"bold",marginLeft:5,marginRight:5}},"every ",i>1?"weeks on":""," ",h()),_());if("monthly"===r){const e="standard"===u?`day ${m}`:`the ${p?.toLowerCase()} ${y}`;return a.default.createElement("div",{style:{marginTop:20}},"Occurs",a.default.createElement("span",{style:{fontWeight:"bold",marginLeft:5,marginRight:5}},e," of every ",i>1?"months":"month"),_())}return a.default.createElement(a.default.Fragment,null)}var L={container:"WeekSelection-module_container__88GLb",weekCheckBoxContainer:"WeekSelection-module_weekCheckBoxContainer__-iuB5",dayContainer:"WeekSelection-module_dayContainer__SF52n",weekCircle:"WeekSelection-module_weekCircle__XtUDq",selectedWeekCircle:"WeekSelection-module_selectedWeekCircle__78txD",checkboxLabel:"WeekSelection-module_checkboxLabel__pBlZa"};function T(t){const{recurrenceData:n,dispatch:o}=e.useContext(c),{selectedWeeks:r,disabled:d}=n,i=e=>{const t=r.includes(e)?r.filter((t=>t!==e)).sort():r.concat([e]).sort();o({type:l.SetSelectedWeeks,payload:t})},u=e=>{let t=e?.target?.value;t&&(t=Number(t),i(t))};return a.default.createElement("div",{style:t?.styles?.weekContainer},a.default.createElement("div",{className:L.container},s.map(((e,t)=>a.default.createElement("div",{key:t,className:L.dayContainer},a.default.createElement("button",{type:"button",disabled:d,value:e.value,className:r.includes(e.value)?L.selectedWeekCircle:L.weekCircle,onClick:t=>i(e.value)},e.name.slice(0,3)))))),a.default.createElement("div",{className:L.weekCheckBoxContainer},s.map((e=>a.default.createElement("label",null,a.default.createElement("input",{disabled:d,checked:r.includes(e.value),type:"checkbox",onChange:u,value:e.value}),a.default.createElement("span",{className:L.checkboxLabel},e.name))))))}function R(t){const{recurrenceData:n,dispatch:o}=e.useContext(c),{repeat:r,selectedWeeks:d,cronExpression:i,monthOption:u,selectedMonthDate:s,selectedMonthDay:m,selectedMonthDayOrder:S,frequency:E,startDate:b,endDate:g,endCount:v,selectedEndType:k}=n;return e.useEffect((()=>{let e={...t};if(t.cronExpression&&""!==t.cronExpression){const a=D(t.repeat,t.cronExpression);a&&(e={...e,...a})}o({type:l.SetInitialProps,payload:e})}),[t]),e.useEffect((()=>{let e="";if("weekly"===r)e=p(d);else if("monthly"===r)if("custom"===u){const t=f(S);"Day"===m?e="Last"===S?"0 0 L * ?":y(t):"Weekday"===m?"First"===S?e="0 0 1W * ?":"Last"===S&&(e="0 0 LW * ?"):e="Last"===S?_(m):h(t,m)}else e=y(s);o({type:l.SetCronExp,payload:e})}),[r,d,u,s,m,S]),e.useEffect((()=>{const e={repeat:r,cronExpression:i,frequency:E,startDate:b};"date"===k?e.endDate=g:"count"===k&&(e.endCount=v),t.onChange&&t.onChange(e)}),[r,i,E,b,g,v,k]),a.default.createElement("div",{style:t?.styles?.root},a.default.createElement(x,t),"weekly"===r?a.default.createElement(T,t):"monthly"===r?a.default.createElement(N,null):null,a.default.createElement(C,null),a.default.createElement(O,null),t.showCronExpression&&a.default.createElement("div",{style:{marginTop:20}},i))}E('@media only screen and (min-width:641px){.WeekSelection-module_container__88GLb{display:flex;flex-direction:row}.WeekSelection-module_weekCheckBoxContainer__-iuB5{display:none}}@media only screen and (max-width:641px){.WeekSelection-module_container__88GLb{display:none}.WeekSelection-module_weekCheckBoxContainer__-iuB5{display:flex;flex-direction:column;margin-top:20px}}.WeekSelection-module_dayContainer__SF52n{margin:10px}.WeekSelection-module_weekCircle__XtUDq{background-color:#aaa}.WeekSelection-module_selectedWeekCircle__78txD,.WeekSelection-module_weekCircle__XtUDq{border:1px;border-color:"#6b6b6b";border-radius:50%;color:#e2e2e2;height:40px;width:40px}.WeekSelection-module_selectedWeekCircle__78txD{background-color:#4eaeec}.WeekSelection-module_checkboxLabel__pBlZa{margin-left:5px}');exports.Recurrence=e=>a.default.createElement(u,null,a.default.createElement(R,n({},e,{root:root})));
